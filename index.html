<!DOCTYPE html>
<html>
<head>
  <title>Editable Calendar</title>
  <style>
    /* CSS styles for the calendar */
    .calendar {
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
      font-family: Arial, sans-serif;
      margin-bottom: 20px;
    }
    
    .calendar .header {
      text-align: center;
      font-size: 24px;
      margin-bottom: 20px;
    }
    
    .calendar .days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }
    
    .calendar .day {
      text-align: center;
      padding: 10px;
      background-color: #eee;
    }
    
    .calendar .day:hover {
      background-color: #ccc;
      cursor: pointer;
    }
    
    .calendar .event {
      background-color: #ffcc00;
      color: #fff;
      padding: 2px;
      font-size: 12px;
      cursor: pointer;
    }

    .calendar .save-button {
      text-align: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="calendar">
    <div class="header">Editable Calendar</div>
    <div class="months"></div>
    <div class="save-button">
      <button onclick="saveEvents()">Save</button>
      <button onclick="loadEventsFromCookies()">Load</button>
    </div>
  </div>

  <script>
    // JavaScript code to populate and handle the calendar

    // Create an array of month names
    const months = [
      'January', 'February', 'March', 'April', 'May', 'June',
      'July', 'August', 'September', 'October', 'November', 'December'
    ];
    
    // Define the events object to store tasks
    let events = {};

    // Load events from the events object
    renderCalendar();

    // Render the calendar
    function renderCalendar() {
      // Get the months container element
      const monthsContainer = document.querySelector('.calendar .months');
      monthsContainer.innerHTML = '';

      // Loop through each month
      for (let monthIndex = 0; monthIndex < 12; monthIndex++) {
        const monthContainer = document.createElement('div');
        monthContainer.classList.add('month');
        
        // Create header for the month
        const header = document.createElement('div');
        header.classList.add('header');
        header.textContent = months[monthIndex];
        monthContainer.appendChild(header);
        
        // Get the current year
        const currentYear = new Date().getFullYear();
        
        // Get the number of days in the current month
        const numDays = new Date(currentYear, monthIndex + 1, 0).getDate();
        
        // Create days container for the month
        const daysContainer = document.createElement('div');
        daysContainer.classList.add('days');
        
        // Add the weekday names to the calendar
        for (let i = 0; i < 7; i++) {
          const day = document.createElement('div');
          day.classList.add('day');
          day.textContent = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'][i];
          daysContainer.appendChild(day);
        }
        
        // Add the days to the calendar
        for (let i = 1; i <= numDays; i++) {
          const day = document.createElement('div');
          day.classList.add('day');
          day.textContent = i;
          
          // Check if there are events for this day
          if (events[currentYear] && events[currentYear][monthIndex] && events[currentYear][monthIndex][i]) {
            const dayEvents = events[currentYear][monthIndex][i];
            dayEvents.forEach(event => {
              const eventDiv = document.createElement('div');
              eventDiv.classList.add('event');
              eventDiv.textContent = event;
              day.appendChild(eventDiv);
            });
          }
          
          daysContainer.appendChild(day);
        }
        
        monthContainer.appendChild(daysContainer);
        monthsContainer.appendChild(monthContainer);
      }
      
      // Add event listeners to the days
      const days = document.querySelectorAll('.calendar .day');
      days.forEach(day => {
        day.addEventListener('click', () => {
          const eventText = prompt('Enter an event for this day:');
          if (eventText) {
            const eventDiv = document.createElement('div');
            eventDiv.classList.add('event');
            eventDiv.textContent = eventText;
            day.appendChild(eventDiv);
            
            // Get the current year and month
            const currentYear = new Date().getFullYear();
            const currentMonth = Array.from(day.parentNode.parentNode.children).indexOf(day.parentNode);
            
            // Store the event in the events object
            if (!events[currentYear]) events[currentYear] = {};
            if (!events[currentYear][currentMonth]) events[currentYear][currentMonth] = {};
            if (!events[currentYear][currentMonth][day.textContent]) events[currentYear][currentMonth][day.textContent] = [];
            events[currentYear][currentMonth][day.textContent].push(eventText);
          }
        });
        
        day.addEventListener('contextmenu', e => {
          e.preventDefault();
          const eventElements = day.querySelectorAll('.event');
          if (eventElements.length > 0) {
            const clickedEvent = e.target.closest('.event');
            if (clickedEvent) {
              const confirmRemove = confirm('Are you sure you want to remove this event?');
              if (confirmRemove) {
                clickedEvent.remove();
                
                // Remove the event from the events object
                const eventText = clickedEvent.textContent;
                const eventDay = day.textContent;
                const eventMonth = Array.from(day.parentNode.parentNode.children).indexOf(day.parentNode);
                const eventYear = new Date().getFullYear();
                if (events[eventYear] && events[eventYear][eventMonth] && events[eventYear][eventMonth][eventDay]) {
                  const index = events[eventYear][eventMonth][eventDay].indexOf(eventText);
                  if (index !== -1) {
                    events[eventYear][eventMonth][eventDay].splice(index, 1);
                    if (events[eventYear][eventMonth][eventDay].length === 0) {
                      delete events[eventYear][eventMonth][eventDay];
                    }
                    if (Object.keys(events[eventYear][eventMonth]).length === 0) {
                      delete events[eventYear][eventMonth];
                    }
                    if (Object.keys(events[eventYear]).length === 0) {
                      delete events[eventYear];
                    }
                  }
                }
              }
            }
          }
        });
      });
    }

    // Save events to cookies
    function saveEvents() {
      // Convert the events object to a string
      const eventsString = JSON.stringify(events);

      // Save the events string to a cookie
      document.cookie = `calendar_events=${encodeURIComponent(eventsString)}; expires=Thu, 31 Dec 2099 23:59:59 GMT`;
    }

    // Load events from cookies
    function loadEventsFromCookies() {
      const cookies = document.cookie.split(';');
      let eventsString = null;
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.startsWith('calendar_events=')) {
          eventsString = decodeURIComponent(cookie.substring('calendar_events='.length));
          break;
        }
      }
      if (eventsString) {
        try {
          events = JSON.parse(eventsString);
          renderCalendar();
        } catch (error) {
          console.error('Error parsing cookie:', error);
        }
      }
    }
  </script>
</body>
</html>
